# ═════════════════════════════════════════════════════════════════════════════
#  v
# Release: 
# 
# ═════════════════════════════════════════════════════════════════════════════

[Unit]
Description=PostgreSQL database for MCP Context Forge
After=network-online.target llm.network.service
Requires=llm.network.service

[Container]
Image=
AutoUpdate=registry
ContainerName=mcp-context-forge-postgres

# ═════════════════════════════════════════════════════════════════════════════
# 🌐 NETWORK - Internal only, no published ports
# ═════════════════════════════════════════════════════════════════════════════
Network=llm.network

# ═════════════════════════════════════════════════════════════════════════════
# 🔐 ENVIRONMENT - No password needed (internal only, trust auth)
# ═════════════════════════════════════════════════════════════════════════════
Environment=POSTGRES_DB=mcp
Environment=POSTGRES_USER=mcp
Environment=POSTGRES_HOST_AUTH_METHOD=trust


# ═════════════════════════════════════════════════════════════════════════════
# 💾 VOLUME
# ═════════════════════════════════════════════════════════════════════════════
Volume=mcp-context-forge-postgres.volume:/var/lib/postgresql/data:Z


# ═════════════════════════════════════════════════════════════════════════════
# 🔧 HEALTH CHECK
# ═════════════════════════════════════════════════════════════════════════════
HealthCmd=pg_isready -U mcp
HealthInterval=30s
HealthTimeout=5s
HealthRetries=5
HealthStartPeriod=10s


# ═════════════════════════════════════════════════════════════════════════════
# 🚀 SERVICE
# ═════════════════════════════════════════════════════════════════════════════
[Service]
Slice=llm.slice
TimeoutStartSec=900
Restart=on-failure
RestartSec=10


[Install]
# No WantedBy - dependencies via After/Requires
